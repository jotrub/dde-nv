###########################################################################
#
# @path procedure prepareDir
#
# @param
#   name of directory NameOfDir in which npsol is to be used
#
# @return
#   true if use of directory is possible, that is, if directory does
#     not yet exist, or if directory does exist and does not contain
#     any files mwrap*
#   false otherwise
#   as a side-effect, directory NameOfDir is created if it does
#     not yet exist
#
# @revision
#   010529 split nested and sequenced if's into some blocks for
#     readability - mmo
#   010503 written by mho
#
###########################################################################
  prepareDir:= proc(
    NameOfDir::string
  )

    local NameOfNPSOLoptionsFile;

    #
    # if directory specified in NameOfDir does not exist, create it
    #
      if not
        Aux:-FileOperations:-dirExists(NameOfDir)
      then
        mkdir(NameOfDir);
      end if;

    #
    # if NPSOL options file does not exist in dir specified in
    # NameOfDir, create it
    #
      NameOfNPSOLoptionsFile:= cat(
        NameOfDir,
        "/npsol_options.txt"
      );
      if not
        Aux:-FileOperations:-fileExists(NameOfNPSOLoptionsFile)
      then
        CreateNPSOLstandardOptionsFile(NameOfDir);
      end if;

    #
    # if file by name "mwrap*" exists in dir specified in NameOfDir,
    # refuse preparation of this dir for NPSOL
    #
    if 
      Aux:-FileOperations:-fileExists(
        cat(NameOfDir, "/mwrap*")
      )
    then
      return(false);
    else
      return(true); 
    end if;
  
  end proc; # prepareDir
  