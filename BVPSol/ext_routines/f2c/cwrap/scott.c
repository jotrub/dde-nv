/****************************************************************************
	This file has been created by MathTIDES (1.20) June 8, 2011, 15:42

	Copyright (C) 2010 A. Abad, R. Barrio, F. Blesa, M. Rodriguez
	Grupo de Mecanica Espacial
	University of Zaragoza
	SPAIN

	http://gme.unizar.es/software/tides
	Contact: <tides@unizar.es>

	This file is part of TIDES.

	TIDES is free software: you can redistribute it and/or modify
	it under the terms of the GNU General Public License as published by
	the Free Software Foundation, either version 3 of the License, or
	(at your option) any later version.

	TIDES is distributed in the hope that it will be useful,
	but WITHOUT ANY WARRANTY; without even the implied warranty of
	MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
	GNU General Public License for more details.

	You should have received a copy of the GNU General Public License
	along with TIDES.  If not, see <http://www.gnu.org/licenses/>.

*****************************************************************************/

#include "scott.h"


long  scott(realNUM t, realNUM v[], realNUM p[], int ORDER, realNUM cvfd[][ORDER+1])
{
	static int   VARIABLES        = 3;
	static int   PARAMETERS       = 2;
	static int   FUNCTIONS        = 0;
	static int   LINKS            = 14;
	static int   PARTIALS_VARS    = 5;
	static long  NUM_DERIVATIVES  = 56;
	static long  NUM_COLUMNS      = 168;

	static int   POS__PARTIALS[5] = {1,2,3,4,5};
	static int   POS_FUNCTIONS[1] = {0};

	static long  POS_ACCUM[57] = {0,1,3,5,7,9,11,14,18,22,26,30,33,37,41,45,48,52,56,59,63,66,70,76,82,88,94,100,108,116,124,130,138,146,152,160,166,170,176,182,188,194,202,210,216,224,230,234,240,246,252,260,266,270,276,282,286};
	static long  POS_COEFS[286] = {1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,3,3,1,1,1,2,2,1,1,1,1,2,2,1,1,1,1,2,2,1,1,1,1,2,2,1,1,1,2,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,1,1,1,1,2,1,1,2,1,1,3,3,1,1,1,2,2,1,1,1,1,2,2,1,1,1,1,2,2,1,1,1,2,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,1,1,1,1,2,1,1,2,1,1,3,3,1,1,1,2,2,1,1,1,1,2,2,1,1,1,2,1,1,2,1,1,1,1,1,1,1,1,1,1,2,1,1,2,1,1,3,3,1,1,1,2,2,1,1,1,2,1,1,2,1,1,3,3,1};
	static long  POS_PREVI[286] = {0,0,1,0,2,0,3,0,4,0,5,0,1,6,0,2,1,7,0,3,1,8,0,4,1,9,0,5,1,10,0,2,11,0,3,2,12,0,4,2,13,0,5,2,14,0,3,15,0,4,3,16,0,5,3,17,0,4,18,0,5,4,19,0,5,20,0,1,6,21,0,2,1,7,6,22,0,3,1,8,6,23,0,4,1,9,6,24,0,5,1,10,6,25,0,2,11,1,7,26,0,3,2,12,1,8,7,27,0,4,2,13,1,9,7,28,0,5,2,14,1,10,7,29,0,3,15,1,8,30,0,4,3,16,1,9,8,31,0,5,3,17,1,10,8,32,0,4,18,1,9,33,0,5,4,19,1,10,9,34,0,5,20,1,10,35,0,2,11,36,0,3,2,12,11,37,0,4,2,13,11,38,0,5,2,14,11,39,0,3,15,2,12,40,0,4,3,16,2,13,12,41,0,5,3,17,2,14,12,42,0,4,18,2,13,43,0,5,4,19,2,14,13,44,0,5,20,2,14,45,0,3,15,46,0,4,3,16,15,47,0,5,3,17,15,48,0,4,18,3,16,49,0,5,4,19,3,17,16,50,0,5,20,3,17,51,0,4,18,52,0,5,4,19,18,53,0,5,20,4,19,54,0,5,20,55};
	static long  POS_PREIV[286] = {0,1,0,2,0,3,0,4,0,5,0,6,1,0,7,1,2,0,8,1,3,0,9,1,4,0,10,1,5,0,11,2,0,12,2,3,0,13,2,4,0,14,2,5,0,15,3,0,16,3,4,0,17,3,5,0,18,4,0,19,4,5,0,20,5,0,21,6,1,0,22,6,7,1,2,0,23,6,8,1,3,0,24,6,9,1,4,0,25,6,10,1,5,0,26,7,1,11,2,0,27,7,8,1,12,2,3,0,28,7,9,1,13,2,4,0,29,7,10,1,14,2,5,0,30,8,1,15,3,0,31,8,9,1,16,3,4,0,32,8,10,1,17,3,5,0,33,9,1,18,4,0,34,9,10,1,19,4,5,0,35,10,1,20,5,0,36,11,2,0,37,11,12,2,3,0,38,11,13,2,4,0,39,11,14,2,5,0,40,12,2,15,3,0,41,12,13,2,16,3,4,0,42,12,14,2,17,3,5,0,43,13,2,18,4,0,44,13,14,2,19,4,5,0,45,14,2,20,5,0,46,15,3,0,47,15,16,3,4,0,48,15,17,3,5,0,49,16,3,18,4,0,50,16,17,3,19,4,5,0,51,17,3,20,5,0,52,18,4,0,53,18,19,4,5,0,54,19,4,20,5,0,55,20,5,0};

	static long  POS_ACCUM_S[57] = {0,1,2,3,4,5,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,39,42,45,48,51,54,58,62,66,69,73,77,80,84,87,90,93,96,99,102,106,110,113,117,120,123,126,129,132,136,139,142,145,148,151};
	static long  POS_COEFS_S[151] = {1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,2,1,1,2,1,1,2,1,1,2,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,2,1,1,2,1,1,2,1,1,2,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,2,1,1,2,1,1,2,1,1,1,1,1,1,2,1,1,2,1,1,2,1,1,2,1,1,2,1};
	static long  POS_PREVI_S[151] = {0,0,0,0,0,0,0,1,0,2,0,3,0,4,0,5,0,2,0,3,0,4,0,5,0,3,0,4,0,5,0,4,0,5,0,5,0,1,6,0,1,6,0,1,6,0,1,6,0,1,6,0,2,11,0,3,2,12,0,4,2,13,0,5,2,14,0,3,15,0,4,3,16,0,5,3,17,0,4,18,0,5,4,19,0,5,20,0,2,11,0,2,11,0,2,11,0,2,11,0,3,15,0,4,3,16,0,5,3,17,0,4,18,0,5,4,19,0,5,20,0,3,15,0,3,15,0,3,15,0,4,18,0,5,4,19,0,5,20,0,4,18,0,4,18,0,5,20,0,5,20};
	static long  POS_PREIV_S[151] = {0,1,2,3,4,5,6,1,7,1,8,1,9,1,10,1,11,2,12,2,13,2,14,2,15,3,16,3,17,3,18,4,19,4,20,5,21,6,1,22,7,2,23,8,3,24,9,4,25,10,5,26,7,1,27,7,8,1,28,7,9,1,29,7,10,1,30,8,1,31,8,9,1,32,8,10,1,33,9,1,34,9,10,1,35,10,1,36,11,2,37,12,3,38,13,4,39,14,5,40,12,2,41,12,13,2,42,12,14,2,43,13,2,44,13,14,2,45,14,2,46,15,3,47,16,4,48,17,5,49,16,3,50,16,17,3,51,17,3,52,18,4,53,19,5,54,19,4,55,20,5};


	if(ORDER < 0) return NUM_COLUMNS;

	static int  NOT_INITIALIZED = 1;
	if(NOT_INITIALIZED)
	{
		set_iterations();
		NOT_INITIALIZED = 0; 
	}
	set_max_order(ORDER);

	realNUM var[VARIABLES+1][NUM_DERIVATIVES][ORDER+1];
	realNUM par[PARAMETERS][NUM_DERIVATIVES][ORDER+1];
	realNUM link[LINKS][NUM_DERIVATIVES][ORDER+1];
	variables_init(var,v,t);
	parameters_init(par,p);
	links_init(link);
	derivatives_init(var,par,v);

	int i;
	for(i=0;  i<=ORDER; i++) {
		var_t(link[13],var[1], i);
		var_t(link[11],var[2], i);
		var_t(link[8],var[3], i);
		mul_t_c("-1.",par[1],link[0],i);
		mul_t_c("0.1",var[3],link[1],i);
		mul_t(var[2],var[2],link[2],i);
		add_t_c("0.0055",link[2],link[3],i);
		exp_t(link[1],link[4],i);
		mul_t_c("-1.",link[2],link[5],i);
		mul_t(link[0],var[3],link[6],i);
		add_t_c("-0.0055",link[5],link[7],i);
		add_t(link[6],var[2],link[8],i);
		mul_t(link[3],var[1],link[9],i);
		mul_t(link[4],par[0],link[10],i);
		sub_t(link[9],var[2],link[11],i);
		mul_t(link[7],var[1],link[12],i);
		add_t(link[10],link[12],link[13],i);
	}

	write_solution(cvfd,var,link);

	return NUM_COLUMNS;
}

long  scott_columns()
{
	 return 169;
}

long  scott_pos_der(char *der)
{
	static char* STR_DER[56] = {"00000","10000","01000","00100","00010","00001","20000","11000","10100","10010","10001","02000","01100","01010","01001","00200","00110","00101","00020","00011","00002","30000","21000","20100","20010","20001","12000","11100","11010","11001","10200","10110","10101","10020","10011","10002","03000","02100","02010","02001","01200","01110","01101","01020","01011","01002","00300","00210","00201","00120","00111","00102","00030","00021","00012","00003"};
	long i;
	for(i=0; i < 56; i++)
		if(strcmp(der,STR_DER[i]) == 0) return i;
	return -1;
}

long  scott_variable_column(int v, char *der)
{
	 return position_variable(v, scott_pos_der, der);
}

long  scott_function_column(int f, char *der)
{
	 return position_function(f, scott_pos_der, der);
}


